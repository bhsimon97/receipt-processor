# Receipt Processing Application

This is a REST API built using Go for the Fetch Backend Developer take-home assignment. This API returns [JSON-encoded](https://www.json.org/json-en.html) responses and uses standard [HTTP response codes](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status).

As requested in the documentation provided by Fetch, there is no persistence of data when the application stops. Information is stored in memory and will be lost when the application stops.

[gorilla/mux](https://github.com/gorilla/mux) was chosen as the request router and dispatcher for pairing incoming requests with the correct handler. Mux was chosen because it is well-documented and provides a lighter footprint than other alternatives such as Gin and Chi, which is nice in smaller applications such as this which won't be scaled up.

# Setup

## Setting up the application without Docker

todo

## Setting up the application with Docker

todo

# Endpoints

The API currently has two endpoints: `/receipts/process` and `/receipts/{id}/points`. You can find more information about and examples using these two endpoints below.

## Process Receipts

**Path**: `/receipts/process`

**Method**: `POST`

**Payload**: Receipt JSON

**Response**: JSON containing an id for the receipt.


**Description**:

Takes in a JSON receipt and returns a JSON object with an ID generated by the API. The ID can then be passed into the `/receipts/{id}/points` endpoint to get the number of points the receipt was awarded.

How many points should be earned is defined by the rules listed in the Rules section below.

**Example Payload**:

    {
        "retailer": "Walgreens",
        "purchaseDate": "2022-01-02",
        "purchaseTime": "08:13",
        "total": "2.65",
        "items": [
            {"shortDescription": "Pepsi - 12-oz", "price": "1.25"},
            {"shortDescription": "Dasani", "price": "1.40"}
        ]
    }

**Example Request via `curl`**:

todo

**Example Response**:

    { "id": "7fb1377b-b223-49d9-a31a-5a02701dd310" }

## Get Points

**Path**: `/receipts/{id}/points`

**Method**: `GET`

**Payload**: None

**Response**: A JSON object containing the number of points awarded.

**Example Request (via cURL)**:

todo

**Example Request (via Fetch API in JavaScript)**:

    let id = yourIdHere;

    fetch(`localhost:8080/receipts/${id}/points`)
        .then((response) => {
    	    return response.json();
        })
        .then((data) => {
    	    // Process the response data as needed
    	    console.log(data);
        })
    	.catch((error) => {
    	    console.error("Error: ", error);
        });

**Example Response**:

    { "points": 32 }

# Rules

These rules collectively define how many points should be awarded to a receipt.

- One points for every alphanumeric character in the retailer name.
- 50 points if the total is a round dollar amount with no cents.
- 25 points if the total is a multiple of `0.25`.
- 5 points for every two items on the receipt.
- If the trimmed length of the item description is a multiple of 3, multiply the price by `0.2` and round up to the nearest integer. The result is the number of points earned.
- 6 points if the day in the purchase date is odd.
- 10 points if the time of purchase is after 2:00pm and before 4:00pm.

## Examples

```json
{
  "retailer": "Target",
  "purchaseDate": "2022-01-01",
  "purchaseTime": "13:01",
  "items": [
    {
      "shortDescription": "Mountain Dew 12PK",
      "price": "6.49"
    },
    {
      "shortDescription": "Emils Cheese Pizza",
      "price": "12.25"
    },
    {
      "shortDescription": "Knorr Creamy Chicken",
      "price": "1.26"
    },
    {
      "shortDescription": "Doritos Nacho Cheese",
      "price": "3.35"
    },
    {
      "shortDescription": "   Klarbrunn 12-PK 12 FL OZ  ",
      "price": "12.00"
    }
  ],
  "total": "35.35"
}
```

```text
Total Points: 28
Breakdown:
     6 points - retailer name has 6 characters
    10 points - 4 items (2 pairs @ 5 points each)
     3 Points - "Emils Cheese Pizza" is 18 characters (a multiple of 3)
                item price of 12.25 * 0.2 = 2.45, rounded up is 3 points
     3 Points - "Klarbrunn 12-PK 12 FL OZ" is 24 characters (a multiple of 3)
                item price of 12.00 * 0.2 = 2.4, rounded up is 3 points
     6 points - purchase day is odd
  + ---------
  = 28 points
```

---

```json
{
  "retailer": "M&M Corner Market",
  "purchaseDate": "2022-03-20",
  "purchaseTime": "14:33",
  "items": [
    {
      "shortDescription": "Gatorade",
      "price": "2.25"
    },
    {
      "shortDescription": "Gatorade",
      "price": "2.25"
    },
    {
      "shortDescription": "Gatorade",
      "price": "2.25"
    },
    {
      "shortDescription": "Gatorade",
      "price": "2.25"
    }
  ],
  "total": "9.00"
}
```

```text
Total Points: 109
Breakdown:
    50 points - total is a round dollar amount
    25 points - total is a multiple of 0.25
    14 points - retailer name (M&M Corner Market) has 14 alphanumeric characters
                note: '&' is not alphanumeric
    10 points - 2:33pm is between 2:00pm and 4:00pm
    10 points - 4 items (2 pairs @ 5 points each)
  + ---------
  = 109 points
```

---
